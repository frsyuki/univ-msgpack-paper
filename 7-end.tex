
\chapter{おわりに}

本論文では、分散システムのためのメッセージ表現手法であるMessagePackについて述べた。

第1章では、本研究の背景および概要について述べた。
今日では、多種多様なサービスをネットワークを通じて多数のユーザーに提供するシステムの構築方法が一般的となっている。これらのシステムを実装するには、異種混合の計算環境においても高い相互互換性を実現する、効率の良いメッセージ表現手法が必要とされていることを提示した。また、そのソフトウェアライブラリとしての使い勝手も重要になる。
そこで本研究の目的は、異種のプログラミング言語・異種の計算機環境・異種のバージョン間で互換性を維持しながら利用可能であり、高速に動作するメッセージ表現手法を設計および実装することで、分散システムの開発を容易にすることに設定した。

第2章では、本研究に関連した先行研究について述べた。
XDR、SunRPC、JSON、Thrift、Protocol Buffers、Avro、JavaRMI、およびCORBAついて、その概要と課題について述べた。

第3章では、MessagePackの設計について述べた。

まず、メッセージ交換手法の設計における課題について述べた。MessagePackでは、どのプログラミング言語にも依存しない、中立的な型システムを定義し、この型システムとプログラミング言語の型システムを相互に変換する仕組みを実装することで、多数のプログラミング言語を横断してメッセージを交換することを可能にした。また、シリアライズ後のデータの中にオブジェクトの型を表す情報を含めることで、シリアライズ後のデータの互換性を損なわずに、そのデータを扱うプログラムを更新することを可能にした。%、プログラムへの機能追加や最適化を妨げないようにした。
このとき、シリアライズ後のデータサイズが増大してしまう問題があるが、MessagePackではより頻繁に利用されると想定される型に対して多くのビットを割り当てることにより、型に関する情報をコンパクトに格納する。

%次に、シリアライズを行うデータ構造を表現する表現形式について述べた。よく使われるであろう値ほど少ないバイト数で表現できるようにすることで空間効率を向上させた。また、シリアライザとデシリアライザの実装を容易にするために、表現形式に規則性を設定した。

第4章では、MessagePackの言語バインディングについて述べた。その特徴は、静的な型付けを採用するプログラミング言語においても、MessagePackの型システムに基づいた動的な型付けを利用可能にした点にある。また同時に、型変換テンプレートと呼ぶ機構を導入することによって、MessagePackの型システムと各言語の型システムの相互変換を可能にした。

第5章では、MessagePackの実装について述べた。
各言語の実装について、コピーを削減して性能を向上させるための最適化を行った。また、オブジェクトの生成コストを削減することによって性能を向上させ、またGC負荷を削減する最適化を行った。

%第6章では、MessagePack-RPCの設計と実装について述べた。
%TODO

第6章では、MessagePackの評価を行った。

MessagePackは、多言語対応を目的の一つした他のシリアライズ形式と比較して対応している言語が非常に多く、その移植性が高いことを示した。MessagePackのすべての機能を実装することは難しいが、MessagePackを最低限利用可能にする実装は簡単であることが、多言語対応を容易にした。

%また、動的型付けオブジェクトAPIと型変換テンプレートの使用方法について述べた。これらのAPIを使用することで、静的型付け言語でも動的型付け言語でもデシリアライズされたオブジェクトを柔軟に扱うことができる。

また、C++、Java、Rubyの各実装について、その性能を測定した。他のシリアライズ形式と比較しても高速に動作することを確認し、実装の最適化によって、高速に動作するメッセージ交換手法を提供する本研究の目的を達成できたことを確認した。

最後に、MessagePackを使用して実際に開発したアプリケーションについて述べた。MessagePackによってメモリやCPUなどの資源の消費量が少なく、高速に動作し、多種のプログラミング言語を横断して利用することができ、異種混合の計算機環境においても高い相互互換性を実現するメッセージ表現手法を容易に利用できるようになったことから、分散システムの実装が容易になったことを確認した。

現在、MessagePackはオープンソースコミュニティによって改善が進められている。各国の開発者によって20以上のプログラミング言語で実装され、様々なサービスで利用されている。
今後もシステムの設計者として開発を先導していく。

%なお、本論文の一部の内容について、情報処理学会第21回コンピュータシステム・シンポジウムポスターセッションにおいて発表を行っている\cite{comsys}。

